<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公路运力预测BP神经网络结构</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        svg {
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
    </style>
</head>

<body>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 600" width="1000" height="600">
        <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
                <polygon points="0 0, 10 3.5, 0 7" fill="#333" />
            </marker>
        </defs>

        <!-- 标题 -->
        <text x="500" y="30" text-anchor="middle" font-size="20" font-weight="bold">公路运力预测BP神经网络结构</text>

        <!-- 输入层 -->
        <g id="input_layer">
            <circle cx="100" cy="150" r="20" fill="#f9f" stroke="#333" stroke-width="2" />
            <circle cx="100" cy="300" r="20" fill="#f9f" stroke="#333" stroke-width="2" />
            <circle cx="100" cy="450" r="20" fill="#f9f" stroke="#333" stroke-width="2" />
            <text x="100" y="520" text-anchor="middle" font-size="14">输入层 (3个节点)</text>
            <text x="100" y="110" text-anchor="middle" font-size="12">人数(万人)</text>
            <text x="100" y="260" text-anchor="middle" font-size="12">机动车数(万辆)</text>
            <text x="100" y="410" text-anchor="middle" font-size="12">公路面积(万平方公里)</text>
        </g>

        <!-- 隐藏层1 -->
        <g id="hidden_layer1">
            <circle cx="350" cy="150" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="200" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="250" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="300" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="350" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="400" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="350" cy="450" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <text x="350" y="520" text-anchor="middle" font-size="14">隐藏层1 (16个节点)</text>
            <text x="350" y="540" text-anchor="middle" font-size="12">ReLU激活</text>
        </g>

        <!-- 隐藏层2 -->
        <g id="hidden_layer2">
            <circle cx="600" cy="225" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="600" cy="275" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="600" cy="325" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <circle cx="600" cy="375" r="15" fill="#bbf" stroke="#333" stroke-width="2" />
            <text x="600" y="520" text-anchor="middle" font-size="14">隐藏层2 (8个节点)</text>
            <text x="600" y="540" text-anchor="middle" font-size="12">ReLU激活</text>
        </g>

        <!-- 输出层 -->
        <circle cx="850" cy="300" r="20" fill="#bfb" stroke="#333" stroke-width="2" />
        <text x="850" y="520" text-anchor="middle" font-size="14">输出层 (1个节点)</text>
        <text x="850" y="260" text-anchor="middle" font-size="12">预测值</text>

        <!-- 连接 -->
        <g stroke="#999" stroke-width="1" opacity="0.3">
            <!-- 输入层到隐藏层1 -->
            <line x1="120" y1="150" x2="335" y2="150" />
            <line x1="120" y1="150" x2="335" y2="450" />
            <line x1="120" y1="300" x2="335" y2="150" />
            <line x1="120" y1="300" x2="335" y2="450" />
            <line x1="120" y1="450" x2="335" y2="150" />
            <line x1="120" y1="450" x2="335" y2="450" />

            <!-- 隐藏层1到隐藏层2 -->
            <line x1="365" y1="150" x2="585" y2="225" />
            <line x1="365" y1="150" x2="585" y2="375" />
            <line x1="365" y1="450" x2="585" y2="225" />
            <line x1="365" y1="450" x2="585" y2="375" />

            <!-- 隐藏层2到输出层 -->
            <line x1="615" y1="225" x2="830" y2="300" />
            <line x1="615" y1="275" x2="830" y2="300" />
            <line x1="615" y1="325" x2="830" y2="300" />
            <line x1="615" y1="375" x2="830" y2="300" />
        </g>

        <!-- Dropout -->
        <text x="475" y="80" text-anchor="middle" font-size="14" fill="#f00">Dropout (0.1)</text>
        <path d="M 475 90 L 475 500" stroke="#f00" stroke-width="1" stroke-dasharray="5,5" />

        <!-- 优化器信息 -->
        <text x="500" y="580" text-anchor="middle" font-size="14">优化器: Adam (lr=0.001, weight_decay=1e-5)</text>
    </svg>
</body>

</html>